# ==============================================================================
# Title: Circos configuration file (cef_str_circos_heatmap)
# Purpose:
#   Draw a circular genome plot with heatmap tracks for LB, Cef, Str, and CefStr.
#   Each TSV provides mutation counts per gene/position, displayed as colored bands.
# ==============================================================================

# Load housekeeping defaults and color/font definitions
<<include etc/housekeeping.conf>>
<<include etc/colors_fonts_patterns.conf>>

# Define karyotype (chromosome structure / coordinates)
karyotype = etc/karyotype.txt

# ---------------------------
# Ideogram (outer chromosome circle)
# ---------------------------
<ideogram>
  <spacing>
    default = 0.005r   # small gap between ideograms (if multiple chromosomes)
  </spacing>
  radius           = 0.85r     # radius of chromosome circle
  thickness        = 40p       # thickness of chromosome band
  show_label       = yes       # display chromosome labels (from karyotype)
  label_font       = bold
  label_size       = 100p      # label text size
  label_radius     = 0.95r     # distance of labels from center
  label_parallel   = yes       # labels follow circle curve
</ideogram>

# ---------------------------
# Data tracks (heatmaps)
# Each <plot> block defines one heatmap ring
# ---------------------------
<plots>

  <plot>
    type  = heatmap
    file  = ../data/LB.tsv        # input table: LB mutations
    r0    = 0.70r                 # inner radius of track
    r1    = 0.80r                 # outer radius of track
    stroke_thickness = 0
    color = reds-3-seq            # color palette
    min   = 0                     # minimum data value
    max   = 3                     # maximum data value
  </plot>

  <plot>
    type  = heatmap
    file  = ../data/Cef.tsv       # Cef mutations
    r0    = 0.60r
    r1    = 0.70r
    stroke_thickness = 0
    color = blues-3-seq
    min   = 0
    max   = 3
  </plot>

  <plot>
    type  = heatmap
    file  = ../data/Str.tsv       # Str mutations
    r0    = 0.50r
    r1    = 0.60r
    stroke_thickness = 0
    color = greens-3-seq
    min   = 0
    max   = 3
  </plot>

  <plot>
    type  = heatmap
    file  = ../data/CefStr.tsv    # Cef + Str combination mutations
    r0    = 0.40r
    r1    = 0.50r
    stroke_thickness = 0
    color = purples-3-seq
    min   = 0
    max   = 3
  </plot>

</plots>

# ---------------------------
# Image output settings
# ---------------------------
<image>
  radius = 4000p                 # overall image size (pixels)
  angle_offset = -90             # rotate so chromosome 1 starts at top
  auto_alpha_colors = yes        # auto transparency for overlapping colors
  auto_alpha_steps = 5
  dir   = .                      # output directory
  file  = cef_str_circos_heatmap.png   # base name of output file
  png   = yes                    # export PNG
  svg   = yes                    # export SVG (vector)
</image>

# ---------------------------
# Misc settings
# ---------------------------
chromosomes_units = 1            # coordinate units (1 = base pairs)